---
title: 环境变量 (Environment Variables)
description: Aperture Daily 后端服务的配置指南。
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

Aperture Daily 使用环境变量来配置数据库连接、LLM 提供商和其他服务。请参考 `server/` 目录下的 `.env.example` 创建 `.env` 文件。

## 数据库配置

系统支持多种数据库驱动。你可以通过 `DB_DRIVER` 变量进行切换。

### 连接设置

<Tabs>
  <TabItem label="SQLite Local (默认)">
    本地开发最快的方式。

    ```bash
    DB_DRIVER=sqlite-local
    DB_CONNECTION=../local.db
    ```
  </TabItem>
  <TabItem label="Turso">
    通过 HTTP/WebSocket 连接到 Turso (LibSQL)。

    ```bash
    DB_DRIVER=turso
    DB_CONNECTION=libsql://your-db.turso.io
    # Turso 专用 Token
    TURSO_AUTH_TOKEN=ey...
    ```
  </TabItem>
  <TabItem label="Cloudflare D1">
    用于 Cloudflare Workers 部署 (`d1-binding`) 或远程 HTTP 访问 (`d1-http`)。

    **通用配置:**
    ```bash
    CLOUDFLARE_ACCOUNT_ID=your-account-id
    CLOUDFLARE_DATABASE_ID=your-db-id
    CLOUDFLARE_DATABASE_NAME=ApertureDailyData
    # 用于 d1-http 驱动以及工具链 (db:pull/push) configuration
    CLOUDFLARE_API_TOKEN=your-api-token
    ```

    - **运行时 (`d1-binding`)**: 无需额外配置，平台会自动注入 `env.DB`。
    - **HTTP 模式 (`d1-http`)**: 需要设置上述变量。
  </TabItem>
  <TabItem label="MySQL / PostgreSQL">
    使用标准连接字符串。

    ```bash
    DB_DRIVER=mysql
    # 或 DB_DRIVER=postgres
    DB_CONNECTION=mysql://user:pass@host:3306/db
    ```
  </TabItem>
</Tabs>

## LLM 配置

使用 `LLM_PROVIDER` 配置你的 AI 提供商。

<Tabs>
  <TabItem label="Gemini">
    ```bash
    LLM_PROVIDER=gemini
    GEMINI_API_KEY=your-api-key
    GEMINI_BASE_URL=https://generativelanguage.googleapis.com
    GEMINI_MODEL=gemini-2.0-flash-thinking-exp
    ```
  </TabItem>
  <TabItem label="OpenAI">
    ```bash
    LLM_PROVIDER=openai
    OPENAI_API_KEY=sk-...
    OPENAI_BASE_URL=https://api.openai.com/v1
    OPENAI_MODEL=gpt-4o
    ```
  </TabItem>
  <TabItem label="Claude">
    ```bash
    LLM_PROVIDER=claude
    ANTHROPIC_API_KEY=sk-ant-...
    ANTHROPIC_BASE_URL=https://api.anthropic.com/v1
    ANTHROPIC_MODEL=claude-3-5-sonnet-20240620
    ```
  </TabItem>
</Tabs>
